# Analyses

![](results.jpg)

bifactor analysis are most commonly applied in the exploration of common method variance [see, for example, @reise_rediscovery_2012;  @rodriguez_evaluating_2016]. @giordano_exploratory_2020 provide an overview regarding past and potential applications of *exploratory* bifactor analysis and cite @reise_rediscovery_2012 as an influential impetus for the resurgence of bifactor models in general. 

```{r data, echo=FALSE, warning=FALSE, message=FALSE}

temp <- read.csv("qualtrics_pilot_data.csv", header=FALSE, na.strings="")

x <- temp[2,]
data <- temp[-c(1:3),]
colnames(data) <- x

num <- nrow(data)

## getting conditions into one large file below - 12/9/20

data$Cond1 <- rowSums(is.na(data[18:53]))
data$Cond2 <- rowSums(is.na(data[54:89]))
data$Cond3 <- rowSums(is.na(data[90:125]))
data$Cond4 <- rowSums(is.na(data[126:161]))

data$Condition[data$Cond1 < 36] <- 1
data$Condition[data$Cond2 < 36] <- 2
data$Condition[data$Cond3 < 36] <- 3
data$Condition[data$Cond4 < 36] <- 4

cond1 <- data[ which(data$Condition==1), ]
cond2 <- data[ which(data$Condition==2), ]
cond3 <- data[ which(data$Condition==3), ]
cond4 <- data[ which(data$Condition==4), ]

cond1.red <- cond1[,c(6, 18:53, 162:165, 171)]  ## using Cond1 ordering
cond2.red <- cond2[,c(6, 62:65, 70:73, 82:85, 58:61, 74:77, 86:89, 66:69, 78:81, 54:57, 162:165, 171)]
cond3.red <- cond3[,c(6, 94:97, 106:109, 118:121, 98:101, 110:113, 122:125, 102:105, 114:117, 90:93, 162:165, 171)]
cond4.red <- cond4[,c(6, 138:161, 130:137, 126:129, 162:165, 171)]        ## 171 versus 172 because testing script has extra "hours" variable

names(cond1.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond1.red))      ## Getting rid of condition markers so rbind will work
names(cond2.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond2.red))  
names(cond3.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond3.red))  
names(cond4.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond4.red))  

together <- rbind(cond1.red, cond2.red, cond3.red, cond4.red)        ## we'll be using this object for analyses

num_valid <- nrow(together)

i <- c(1:37)                                          ## Changing item responses to numerics
together[ , i] <- apply(together[ , i], 2,            # Specify own function within apply
                    function(x) as.numeric(as.character(x)))

library(descr)
# freq(together$`Duration (in seconds)`)



# Interactive plot
library(reshape2)
mcor<-together[,2:37]
               
mcor<-mcor[c(33,34,35,36,
              1,2,3,4,
              13,14,15,16,
              25,26,27,28,
              5,6,7,8,
              17,18,19,20,
              29,30,31,32,
              9,10,11,12,
              21,22,23,24)]

mcor<-round(cor(mcor, use="na.or.complete" ),2)

get_upper_tri <- function(mcor){
  mcor[lower.tri(mcor)]<- NA
  return(mcor)}

upper_tri<-get_upper_tri(mcor)

melted_cor<-melt(upper_tri, na.rm = TRUE)


library(ggplot2)
cor.plot<-ggplot(data=melted_cor, aes(Var1, Var2, fill=value))+
  geom_tile(color="white")+
  scale_fill_gradient2(low="blue",high="red",mid="white",
                       midpoint = 0, limit= c(-1,1), space = "Lab",
                       name="Attitudinal Correlation")+
  theme_minimal()+
  theme(axis.text = element_blank())+
  coord_fixed()



library(plotly)
 ggplotly(cor.plot)



```

## Pilot analyses

`r num_valid` people responded. Probably need to further screen for duration. This is the number of seconds to complete the entire survey (according to communications with Qualtrics in early December). It looks like our "number of people who clicked on the assessment link (`r num`)" versus valid *n* (`r num_valid`) took care of our very low duration respondents. The lowest in the `r num` datafile is `r min(data$Duration)` whereas the lowest in the `r num_valid` datafile is `r min(together$Duration)`.

### Classical test theory

Inter-item correlations are located in Appendix \@ref(corrs).


corrected item-total correlations and alphas by condition


```{r alphas, echo=FALSE, warning=FALSE, message=FALSE}

## recodes 12/9/20

## AFFECTIVE: 

together$`Most days, I feel happiest when the workday is soon to be complete.` <- 7 - together$`Most days, I feel happiest when the workday is soon to be complete.`
together$`This job drains my energy.` <- 7 - together$`This job drains my energy.`

## BEHAVIORAL (NONE):

## COGNITIVE: 

together$`Thinking about work saps my energy.` <- 7 - together$`Thinking about work saps my energy.`
together$`I often think about finding another job.` <- 7 - together$`I often think about finding another job.`


affect <- psych::alpha(together[2:13])  
behave <- psych::alpha(together[14:25])
cogni <- psych::alpha(together[26:37])

absorb <- psych::alpha(together[c(2:5, 14:17, 34:37)])  
vigor <- psych::alpha(together[c(26:29, 6:9, 18:21)])
dedic <- psych::alpha(together[c(30:33, 10:13, 22:25)])

aff.abs <- psych::alpha(together[2:5])
aff.vig <- psych::alpha(together[6:9])
aff.ded <- psych::alpha(together[10:13])

beh.abs <- psych::alpha(together[14:17])
beh.vig <- psych::alpha(together[18:21])
beh.ded <- psych::alpha(together[22:25])

cog.abs <- psych::alpha(together[34:37])
cog.vig <- psych::alpha(together[26:29])
cog.ded <- psych::alpha(together[30:33])

one <- together[ which(together$Condition == 1), ]
two <- together[ which(together$Condition == 2), ]
three <- together[ which(together$Condition == 3), ]
four <- together[ which(together$Condition == 4), ]

aff.1 <- psych::alpha(one[2:13]) 
beh.1 <- psych::alpha(one[14:25])
cog.1 <- psych::alpha(one[26:37])
abs.1 <- psych::alpha(one[c(2:5, 14:17, 34:37)])  
vig.1 <- psych::alpha(one[c(26:29, 6:9, 18:21)])
ded.1 <- psych::alpha(one[c(30:33, 10:13, 22:25)])

aff.2 <- psych::alpha(two[2:13]) 
beh.2 <- psych::alpha(two[14:25])
cog.2 <- psych::alpha(two[26:37])
abs.2 <- psych::alpha(two[c(2:5, 14:17, 34:37)])  
vig.2 <- psych::alpha(two[c(26:29, 6:9, 18:21)])
ded.2 <- psych::alpha(two[c(30:33, 10:13, 22:25)])

aff.3 <- psych::alpha(three[2:13]) 
beh.3 <- psych::alpha(three[14:25])
cog.3 <- psych::alpha(three[26:37])
abs.3 <- psych::alpha(three[c(2:5, 14:17, 34:37)])  
vig.3 <- psych::alpha(three[c(26:29, 6:9, 18:21)])
ded.3 <- psych::alpha(three[c(30:33, 10:13, 22:25)])

aff.4 <- psych::alpha(four[2:13]) 
beh.4 <- psych::alpha(four[14:25])
cog.4 <- psych::alpha(four[26:37])
abs.4 <- psych::alpha(four[c(2:5, 14:17, 34:37)])  
vig.4 <- psych::alpha(four[c(26:29, 6:9, 18:21)])
ded.4 <- psych::alpha(four[c(30:33, 10:13, 22:25)])

```

#### Internal consistency estimates

Condition 1 administered items within the substantive dimensions (with successive randomized blocks of Cognitive, Affective, and Behavioral items). Condition 2 administered items within the attitudinal dimensions (with successive randomized blocks of Absorption, Vigor, and Dedication items). Condition 3 stressed the substantive dimensions (with items fully randomized regardless of attitudinal association). Condition 4 stressed the attitudinal dimensions (with items fully randomized within attitudinal dimension regardless of substantive scale association, see Chapter \@ref(conds) and Appendix \@ref(pilot2)).

| Dimension      | Undifferentiated                        | Condition 1                       |  Condition 2                      | Condition 3                       | Condition 4                       |
|----------------|-----------------------------------------|-----------------------------------|-----------------------------------|-----------------------------------|-----------------------------------|
| Affective      | `r round(affect$total$raw_alpha, 2)`    |`r round(aff.1$total$raw_alpha, 2)`|`r round(aff.2$total$raw_alpha, 2)`|`r round(aff.3$total$raw_alpha, 2)`|`r round(aff.4$total$raw_alpha, 2)`|  
| Behavioral     | `r round(behave$total$raw_alpha, 2)`    |`r round(beh.1$total$raw_alpha, 2)`|`r round(beh.2$total$raw_alpha, 2)`|`r round(beh.3$total$raw_alpha, 2)`|`r round(aff.4$total$raw_alpha, 2)`| 
| Cognitive      | `r round(cogni$total$raw_alpha, 2)`     |`r round(cog.1$total$raw_alpha, 2)`|`r round(cog.2$total$raw_alpha, 2)`|`r round(cog.3$total$raw_alpha, 2)`|`r round(aff.4$total$raw_alpha, 2)`| 
|                |                                         |                                   |                                   |                                   |                                   |
| Absorption     | `r round(absorb$total$raw_alpha, 2)`    |`r round(abs.1$total$raw_alpha, 2)`|`r round(abs.2$total$raw_alpha, 2)`|`r round(abs.3$total$raw_alpha, 2)`|`r round(aff.4$total$raw_alpha, 2)`| 
| Vigor          | `r round(vigor$total$raw_alpha, 2)`     |`r round(vig.1$total$raw_alpha, 2)`|`r round(vig.2$total$raw_alpha, 2)`|`r round(vig.3$total$raw_alpha, 2)`|`r round(aff.4$total$raw_alpha, 2)`| 
| Dedication     | `r round(dedic$total$raw_alpha, 2)`     |`r round(ded.1$total$raw_alpha, 2)`|`r round(ded.2$total$raw_alpha, 2)`|`r round(ded.3$total$raw_alpha, 2)`|`r round(aff.4$total$raw_alpha, 2)`| 

"Cell" level alphas (collapsed responses across conditions) were:

| Cell                       | Alpha                                |
|----------------------------|--------------------------------------|
| Affective - Absorption     |`r round(aff.abs$total$raw_alpha, 2)` |
| Affective - Vigor          |`r round(aff.vig$total$raw_alpha, 2)` |
| Affective - Dedication     |`r round(aff.ded$total$raw_alpha, 2)` |
|                            |                                      |
| Behavioral - Absorption    |`r round(beh.abs$total$raw_alpha, 2)` |
| Behavioral - Vigor         |`r round(beh.vig$total$raw_alpha, 2)` |
| Behavioral - Dedication    |`r round(beh.ded$total$raw_alpha, 2)` |
|                            |                                      |
| Cognitive - Absorption     |`r round(cog.abs$total$raw_alpha, 2)` |
| Cognitive - Vigor          |`r round(cog.vig$total$raw_alpha, 2)` |
| Cognitive - Dedication     |`r round(cog.ded$total$raw_alpha, 2)` |

Corrected item-total correlations are presented in Appendix \@ref(rdrops) 

### Confirmatory factor analyses

#### Multigroup analyses

+ using experimental condition as "multiple groups" (measurement invariance)

#### Bifactor analyses

+ looking at dual structure

### Summary

Recommendation for final instrument based on consideration of all of the above pieces of evidence

## Construct and Criterion-related Validation

Use Gallup for construct validation [@thackray_gallup_2005; @harter_relationship_2013]. Also the Utrecht Work Engagement Scale [UWES; @schaufeli_measurement_2002; @schaufeli_defining_2010]
