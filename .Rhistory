#####################################################################################
#####################################################################################
## Bifactor below (5/19/21): ######## THIS IS FULL 36-item PROBLEMATIC SPECIFICATION ##########
Bifactor_Model<-'
Cognitive=~Item_1+Item_2+Item_3+Item_4+Item_13+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_17+Item_18+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_9+Item_10+Item_11+Item_12+Item_21+Item_22+Item_23+Item_24+Item_33+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_2+Item_3+Item_4+Item_5+Item_6+Item_7+Item_8+Item_9+Item_10+Item_11+Item_12
Vigor=~Item_13+Item_14+Item_15+Item_16+Item_17+Item_18+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_33+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
#Cognitive ~~ Affective
#Cognitive ~~ Behavioral
#Affective ~~ Behavioral
#Absorption ~~ Vigor
#Absorption ~~ Dedication
#Vigor ~~ Dedication'
Fit.Bi <- lavaan::cfa(Bifactor_Model, data = CFAdata) #, likelihood = "wishart")
semPlot::semPaths(Fit.Bi, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)  ## exoCov=FALSE deletes all covariances
title("Initial pilot bifactor analysis (36 candidate items)")
modindices(Fit.Bi, sort = TRUE, maximum.number = 5)
summary(Fit.Bi)
#############################################################################################
#############################################################################################
#############################################################################################
#############################################################################################
################################# Minus 2 and 12 ############################################
#############################################################################################
#############################################################################################
#############################################################################################
## delete items 2, 12 (remember to do twice on all iterations)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_13+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_17+Item_18+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_9+Item_10+Item_21+Item_22+Item_23+Item_24+Item_33+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_9+Item_10
Vigor=~Item_13+Item_14+Item_15+Item_16+Item_17+Item_18+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_33+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
#Dedication ~~ 0*Vigor
#Dedication ~~ 0*Absorption
#Vigor ~~ 0*Absorption
#Affective ~~ 0*Behavioral
#Affective ~~ 0*Cognitive
#Behavioral ~~ 0*Cognitive
#'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
#############################################################################################
#############################################################################################
#############################################################################################
#############################################################################################
################################# Play Here #################################################
#############################################################################################
#############################################################################################
#############################################################################################
## delete items 2, 12
## delete 33, 9
## deleted if: 1) modification index was high (relative to others) and 2) error residual was within same cell
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_17+Item_18+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_10+Item_21+Item_22+Item_23+Item_24+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_10
Vigor=~Item_14+Item_15+Item_16+Item_17+Item_18+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
#Dedication ~~ 0*Vigor
#Dedication ~~ 0*Absorption
#Vigor ~~ 0*Absorption
#Affective ~~ 0*Behavioral
#Affective ~~ 0*Cognitive
#Behavioral ~~ 0*Cognitive
#'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
## write.csv(psych::describe(CFAdata), "descriptives.csv")
summary(Fit.mod1)
library(tidyverse)
glimpse(CFAdata)
semPlot::semPaths(Fit2.2, "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
semPlot::semPaths(Fit.Bi, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)  ## exoCov=FALSE deletes all covariances
semPlot::semPaths(Fit.Bi, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)  ## exoCov=FALSE deletes all covariances
summary(Fit.Bi)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_13+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_18+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_9+Item_10+Item_21+Item_22+Item_23+Item_24+Item_33+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_9+Item_10
Vigor=~Item_13+Item_14+Item_15+Item_16+Item_18+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_33+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
summary(Fit.mod1)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_13+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_17+Item_18+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_9+Item_10+Item_21+Item_22+Item_23+Item_24+Item_33+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_9+Item_10
Vigor=~Item_13+Item_14+Item_15+Item_16+Item_17+Item_18+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_33+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_13+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_18+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_9+Item_10+Item_21+Item_22+Item_23+Item_24+Item_33+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_9+Item_10
Vigor=~Item_13+Item_14+Item_15+Item_16+Item_18+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_33+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_13+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_17Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_9+Item_10+Item_21+Item_22+Item_23+Item_24+Item_33+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_9+Item_10
Vigor=~Item_13+Item_14+Item_15+Item_16+Item_17+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_33+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_13+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_17+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_9+Item_10+Item_21+Item_22+Item_23+Item_24+Item_33+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_9+Item_10
Vigor=~Item_13+Item_14+Item_15+Item_16+Item_17+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_33+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_13+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_18+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_9+Item_10+Item_21+Item_22+Item_23+Item_24+Item_33+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_9+Item_10
Vigor=~Item_13+Item_14+Item_15+Item_16+Item_18+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_33+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
summary(Fit.mod1)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_13+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_18+Item_19+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_9+Item_10+Item_21+Item_22+Item_23+Item_24+Item_33+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_9+Item_10
Vigor=~Item_13+Item_14+Item_15+Item_16+Item_18+Item_19+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_33+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_13+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_18+Item_19+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_9+Item_10+Item_21+Item_22+Item_23+Item_24+Item_33+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_9+Item_10
Vigor=~Item_13+Item_14+Item_15+Item_16+Item_18+Item_19+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_33+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_13+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_18+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_9+Item_10+Item_21+Item_22+Item_23+Item_24+Item_33+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_9+Item_10
Vigor=~Item_13+Item_14+Item_15+Item_16+Item_18+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_33+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
Fit.mod1
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_18+Item_19+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_10+Item_21+Item_22+Item_23+Item_24+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_10
Vigor=~Item_14+Item_15+Item_16+Item_18+Item_19+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_18+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_10+Item_21+Item_22+Item_23+Item_24+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_10
Vigor=~Item_14+Item_15+Item_16+Item_18+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
Fit.mod1
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_18+Item_19+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_10+Item_21+Item_22+Item_23+Item_24+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_10
Vigor=~Item_14+Item_15+Item_16+Item_18+Item_19+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_10+Item_21+Item_22+Item_23+Item_24+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_10
Vigor=~Item_14+Item_15+Item_16+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
modified1 <-'
Cognitive=~Item_1+Item_3+Item_2+Item_14+Item_15+Item_16+Item_25+Item_26+Item_27+Item_28
Affective=~Item_5+Item_6+Item_7+Item_8+Item_19+Item_20+Item_29+Item_30+Item_31+Item_32
Behavioral=~Item_10+Item_21+Item_22+Item_23+Item_24+Item_34+Item_35+Item_36
Absorption=~Item_1+Item_3+Item_2+Item_5+Item_6+Item_7+Item_8+Item_10
Vigor=~Item_14+Item_15+Item_16+Item_19+Item_20+Item_21+Item_22+Item_23+Item_24
Dedication=~Item_25+Item_26+Item_27+Item_28+Item_29+Item_30+Item_31+Item_32+Item_34+Item_35+Item_36
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor ~~ 0*Affective
Vigor ~~ 0*Behavioral
Vigor ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'
Fit.mod1 <- lavaan::cfa(modified1, data = CFAdata)
semPlot::semPaths(Fit.mod1, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0)
modindices(Fit.mod1, sort = TRUE, maximum.number = 25)
summary(Fit.mod1)
cars
a <- cars
a[3,] = c(NA,NA)
a
?which
# Morgan factorizes the "What is the title of the job you were thinking about while responding to this survey?" column
# As well as the "How many hours do you typically work per week in this job?" column
# An object lesson in why you should NEVER HAVE FREE TEXT ENTRY IN YOUR SURVEY
# Packages
library(tidyverse)
library(DT)
temp <- read.csv("qualtrics_pilot_data.csv", header=FALSE, na.strings="")
x <- temp[2,]
data <- temp[-c(1:3),]
colnames(data) <- x
num <- nrow(data)
## getting conditions into one large file below - 12/9/20
data$Cond1 <- rowSums(is.na(data[18:53]))
data$Cond2 <- rowSums(is.na(data[54:89]))
data$Cond3 <- rowSums(is.na(data[90:125]))
data$Cond4 <- rowSums(is.na(data[126:161]))
data$Condition[data$Cond1 < 36] <- 1
data$Condition[data$Cond2 < 36] <- 2
data$Condition[data$Cond3 < 36] <- 3
data$Condition[data$Cond4 < 36] <- 4
cond1 <- data[ which(data$Condition==1), ]
cond2 <- data[ which(data$Condition==2), ]
cond3 <- data[ which(data$Condition==3), ]
cond4 <- data[ which(data$Condition==4), ]
cond1.red <- cond1[,c(6, 18:53, 162:165, 171)]  ## using Cond1 ordering
cond2.red <- cond2[,c(6, 62:65, 70:73, 82:85, 58:61, 74:77, 86:89, 66:69, 78:81, 54:57, 162:165, 171)]
cond3.red <- cond3[,c(6, 94:97, 106:109, 118:121, 98:101, 110:113, 122:125, 102:105, 114:117, 90:93, 162:165, 171)]
cond4.red <- cond4[,c(6, 138:161, 130:137, 126:129, 162:165, 171)]        ## 171 versus 172 because testing script has extra "hours" variable
names(cond1.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond1.red))      ## Getting rid of condition markers so rbind will work
names(cond2.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond2.red))
names(cond3.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond3.red))
names(cond4.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond4.red))
together <- rbind(cond1.red, cond2.red, cond3.red, cond4.red)        ## we'll be using this object for analyses
# Hours worked
unique(together$`How many hours do you typically work per week in this job?`) # Sixty-two unique responses
gsub("[^0-9.-]", "", together$`How many hours do you typically work per week in this job?`)
together$`How many hours do you typically work per week in this job?`
together$`How many hours do you typically work per week in this job?` <- together$`How many hours do you typically work per week in this job?` %>%
gsub("[^0-9./-]", "", .) %>%  # removes all characters not included in brackets
gsub(".*/", "", .) %>% # Selects second number after "/" (e.g. 40/50 -> 50)
gsub(".*-", "", .) %>%  # Selects second number after "-" (e.g. 50-60 -> 60)
gsub("[^0-9]", "", .) %>% # Removes
str_sub(1,2) %>% # Subsets all responses to first two indices. Quick and easy way to rule out impossible hour entries
as.numeric()
# Organizational tenure
# This is going to be a doozy and will require some imperfect text analysis
together$tenure <- together[40]
hold <- head(together[40]) %>%  #%>% #test data for playing with temp
as.vector()
months <- str_detect(hold[,1], "month") #logical vector for whether row contains month
years <- str_detect(hold[,1], "year") #logical vector for whether row contains year
#and no clue how to do more than this
#Job title
unique(together$`What is the title of the job you were thinking about while responding to this survey?`) # Two-hundred and thirty-seven unique responses
together$`What is the title of the job you were thinking about while responding to this survey?`
#ONET job clusters, for use as factor levels
onet <- c('Agriculture, Food & Natural Resources', 'Archtecture & Construction', 'Arts, Audio/Video Technology & Communications',
'Business Management & Administration', 'Education & Training', 'Finance', 'Government & Public Administration',
'Health Science', 'Hospitality & Tourism', 'Human Services', 'Information Technology', 'Law, Public Safety, Corrections & Security',
'Manufacturing', 'Marketing', 'Science, Technology, Engineering & Mathematics', 'Transportation, Distribution & Logistics')
together$`What is the title of the job you were thinking about while responding to this survey?` %>%
tolower() %>%
trimws()
#creates demographic table using DT library
demo_table <- together[38:40] %>%
filter_all(any_vars(!is.na(.))) %>% #changed DT to filter out rows where all col values == NA
datatable()
# To do:
# Find quick and easy classification
# include as appendix in SIOPpapaja
# make as searchable table inside tech report via "DT" package
#     May only work inside HTML version
# include other demo data (e.g. hours worked)
# Down the line:
# management/non management
demo_table
nrow(together)
nrow(demo_table)
nrow(as.table(demo_table))
glimpse(together)
View(att.csv)
View('att.csv')
