---
title             : "Development of an Intentional Bifactor Engagement Measure"
shorttitle        : "BiFactor Engagement"

author: 
  - name          : "Morgan Russell"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "1 Normal Ave, Montclair, NJ 07043"
    email         : "russellm5@montclair.edu"
  - name          : "Casey Osorio-Duffoo"
    affiliation   : "2"
  - name          : "Renata Garcia Prieto Palacios Roji"
    affiliation   : "1"
  - name          : "John Kulas"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "Montclair State University"
  - id            : "2"
    institution   : "Harver"

authornote: |
  Add complete departmental affiliations for each author here. Each new line herein must be indented, like this line.

  Enter author note here.

abstract: |
  Employee engagement has recently enjoyed a surge in interest as a positive employee outcome despite continued disageement regarding its factor structure and nomological relationship to other constructs, like burnout.
  We contrast two three-factor models of engagement: substantive, with the dimensions vigor, dedication and absorption, and attitudinal, with cognitive, affective and behavioral dimensions.
  Using bifactor analysis, study 1 proposes a scale that reconciles these two models and reduces 36 candidate items to 18.
  Study 2 convergently and discriminantly validates this scale.
  
  <!-- https://tinyurl.com/ybremelq -->
  
keywords          : "Engagement, bifactor analysis"
wordcount         : "X"

bibliography      : ["r-references.bib", "engage.bib", "siopadds.bib", "bifactor.bib", "book.bib", "renata.bib"]

floatsintext      : no #change to yes if we want all tables to be put in-line rather than pushed to end of paper
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no
numbersections    : no

csl               : "apa7.csl"
documentclass     : "apa7"
classoption       : "man"
output            : papaja::apa6_word
---

```{r setup, include = FALSE}
library("papaja")
r_refs("r-references.bib")
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed)
```

# Introduction

The term engagement within the context of work emerged in organizational psychology and business literature in the early 1990s [@kahn1990psychological]. Today, there are four main lines of research focused on engagement: personal engagement, burnout/engagement, work engagement, and employee engagement. These four constructs are defined and measured differently across the literature, making it hard to determine what exactly is being measured when organizations survey their employees to assess “engagement”. Work engagement has been defined as “the positive, fulfilling, work-related state of mind that is characterized by vigor, dedication, and absorption. Vigor is characterized by high levels of energy and mental resilience while working. Dedication refers to being strongly involved in one’s work and experiencing a sense of significance, enthusiasm, inspiration, pride, and challenge. Absorption is characterized by being fully concentrated and happily engrossed in one’s work, whereby time passes quickly and one has difficulties with detaching oneself from work” (@schaufeli_measurement_2002). Individuals who are engaged in their work are known to have high levels of energy, enthusiasm, and are completely immersed in their work tasks (Bakker et al., 2018). Based on the @@schaufeli_measurement_2002 definition of engagement we conceptualize engagement as a mental state wherein employees feel energized, are enthusiastic about the content of their work and the things they do, and are so immersed in their work activities that time seems compressed. 

There is a large body of evidence supporting the relationships between work engagement and organizational outcomes, including those which are performance based (Simpson, 2008). Which is why despite the lack of clarity around the construct, work engagement has emerged as an important component of an organization’s overall health and strategy. Given the potential outcomes of either having or lacking employees who experience work engagement. Across the literature you can find different trends in work engagement research, such as studying work engagement as a phenomenon that fluctuates within individuals, episodic work engagement, organizational-level work engagement, and leadership and work engagement. A relevant topic in recent literature is how dynamic work engagement can be. Bakker and colleagues (2018) point out that for organizational practice, it is important to understand that employees experience fluctuating levels of engagement at work and what causes these fluctuations (e.g., culture, environment, leadership, etc.). Although it is important that research continues to improve our understanding of the nature, causes, and outcomes of work engagement, it is also important that this knowledge is transferred to practical applications that can benefit both individuals and organizations. An important aspect of accumulating knowledge on the subject, is the methodological component of how that knowledge is built.

# Models

Like many other constructs within the psychology literature, knowledge on work engagement has been built based on its measurement and linkage to other work outcomes. There are currently many work engagement scales used for either academic or applied purposes (sometimes both), which provide work engagement scores at the individual level. Most of these scales are measuring latent constructs that are not work engagement per se, but are intended to capture elements of this construct through indicators of other latent constructs. For example, the idea that vigor, dedication, and absorption together form the foundation of work engagement forms the basis of the Utrecht Work Engagement Scale (UWES; @schaufeli_measurement_2002). Despite its wide use and recognition, the UWES has been subject to criticism due to its development methodology and factorial structure [@willmer_exploratory_2019]. A central criticism is that the three subscales; vigor, dedication and absorption are closely correlated with each other, making it hard to argue that the three-factor structure is better than the single factor structure to measure work engagement [@kulikowski_we_2017]. However, the UWES is still a widely used measure and its subscales are used to identify the specific subcategories of work engagement that need improvement. Given their popularity, the subscales within this theoretical framework are used as the first theoretical model for this project (see Figure 1). 

To our knowledge, the first use of the word "engagement" as a construct came from @kahn1990psychological, who defined it as: "the harnessing of organization members' selves to their work roles; in engagement, people employ and express themselves physically, cognitively, and emotionally during role performances." Although this definition was quickly bypassed by subsequent papers (see, for example, @baumruk2004missing and @shaw2005engagement, who framed it in terms of one's cognitive and affective *commitment* to one's organization), @kahn1990psychological's definition is notable in that it conforms to the then-ascendant tripartite model of attitudes proposed by @rosenberg_cognitive_1960. This model frames attitudes as latent variables that manifest cognitively, affectively and behaviorally. The tripartite model of attitude emerged from the Yale Communication and Attitude program in the 1950’s. It is a latent variable model based on the assumption that the latent variable elicits three types of responses or manifestations: a persons’ cognitive, affective, and behavioral responses to a specific attitude (@kaiser_campbell_2019). Even though it is not specifically a work engagement model, the tripartite model has helped researchers define and deconstruct attitudes to gain a better understanding of individuals’ responses towards specific attitude objects (@kaiser_campbell_2019). 

# Bifactor structures 

Bifactor analysis is part of the exploratory factor analytic domain and is used to account for variance in observed variables from the effects of latent or general factors [@giordano_exploratory_2020]. In most applications the latent constructs included in bifactor models are mutually orthogonal (i.e., uncorrelated), and represent the broad target constructs an instrument was designed to measure. Bifactor models are best suited to represent the multidimensionality arising from item responses that aim to measure broader constructs through multiple domains or subcategories [@reise_rediscovery_2012]. Additionally, these models can be classified as constrained hierarchical bifactor models and unconstrained non-hierarchical bifactor models [@giordano_exploratory_2020]. For the purposes of this project, an unconstrained non-hierarchical model is used to determine which group factors represent substantive and attitudinal constructs. The resulting general factors in the non-hierarchical model have a direct (i.e., non-mediated) relationship with each variable observed. In this case, each general factor from both substantive and attitudinal models have non-mediated but overlapping effects on each variable. 


> we need to do some market research on the Q12: 1. what's the feedback report look like? (google images show one overall "satsifaction" score and/or one overall "engagement" score), 2. how much does it cost, 3. what are the 200 pulse items Gallup refers to? (6/7/21)



This model is not without criticism, however. Some critics question its structural validity by pointing out that vigor, dedication and absorption all correlate highly with each other [@kulikowski2017we].

> need more on criticisms of model

The present article explores two methods for constructing a scale that incorporates both the substantive and attitudinal models into one, a more classical one based on corrected item-total correlations and one based on modification indices.

# Methods

Choice of focus on BIC versus AIC discussed in @dziak2020sensitivity.

```{r getData, echo=FALSE, warning=FALSE}
#PASTED CURRENT VERSION OF 'MORGAN JOB TITLE HOURS WORKED'
#KEEP UP TO DATE
# Morgan factorizes the "What is the title of the job you were thinking about while responding to this survey?" column
# As well as the "How many hours do you typically work per week in this job?" column

# An object lesson in why you should NEVER HAVE FREE TEXT ENTRY IN YOUR SURVEY


# Packages
library(tidyverse)
library(DT)
library(labourR)
library(apaTables)


temp <- read.csv("qualtrics_pilot_data.csv", header=FALSE, na.strings="")

x <- temp[2,]
data <- temp[-c(1:3),]
colnames(data) <- x

num <- nrow(data)

## getting conditions into one large file below - 12/9/20

data$Cond1 <- rowSums(is.na(data[18:53]))
data$Cond2 <- rowSums(is.na(data[54:89]))
data$Cond3 <- rowSums(is.na(data[90:125]))
data$Cond4 <- rowSums(is.na(data[126:161]))

data$Condition[data$Cond1 < 36] <- 1
data$Condition[data$Cond2 < 36] <- 2
data$Condition[data$Cond3 < 36] <- 3
data$Condition[data$Cond4 < 36] <- 4

cond1 <- data[ which(data$Condition==1), ]
cond2 <- data[ which(data$Condition==2), ]
cond3 <- data[ which(data$Condition==3), ]
cond4 <- data[ which(data$Condition==4), ]

cond1.red <- cond1[,c(6, 18:53, 162:165, 171)]  ## using Cond1 ordering
cond2.red <- cond2[,c(6, 62:65, 70:73, 82:85, 58:61, 74:77, 86:89, 66:69, 78:81, 54:57, 162:165, 171)]
cond3.red <- cond3[,c(6, 94:97, 106:109, 118:121, 98:101, 110:113, 122:125, 102:105, 114:117, 90:93, 162:165, 171)]
cond4.red <- cond4[,c(6, 138:161, 130:137, 126:129, 162:165, 171)]        ## 171 versus 172 because testing script has extra "hours" variable

names(cond1.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond1.red))      ## Getting rid of condition markers so rbind will work
names(cond2.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond2.red))  
names(cond3.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond3.red))  
names(cond4.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond4.red))  

together <- rbind(cond1.red, cond2.red, cond3.red, cond4.red)        ## we'll be using this object for analyses

# Hours worked
together$`How many hours do you typically work per week in this job?` <- together$`How many hours do you typically work per week in this job?` %>% 
  gsub("[^0-9./-]", "", .) %>%  # removes all characters not included in brackets
  gsub(".*/", "", .) %>% # Selects second number after "/" (e.g. 40/50 -> 50)
  gsub(".*-", "", .) %>%  # Selects second number after "-" (e.g. 50-60 -> 60)
  gsub("[^0-9]", "", .) %>%
  str_sub(1,2) %>% # Subsets all responses to first two indices. Quick and easy way to rule out impossible hour entries
  as.numeric()

#Job title

#creates new column 'position' detecting presence of keywords. To create new search terms, copy the "str_detect" line
together <- together %>% 
  mutate_at(vars(`What is the title of the job you were thinking about while responding to this survey?`), 
            list(position =~ case_when(str_detect(., regex("account"))~"accountant",
                                       str_detect(., regex("analy"))~"analyst",
                                       TRUE~.)))

together$position <- together$`What is the title of the job you were thinking about while responding to this survey?` %>% 
  tolower() %>% 
  trimws()

#ESCO/ISCO classification using the labourR package
#ISCO = International Standard Classification of Occupations

together$id <- 1:nrow(together) #adds unique identifier to satisfy inane requirement of classify_occupation()

ISCO <- classify_occupation(together, text_col = 'position', isco_level = 1) #nrow = 249 (I think BC it ignores NA's?)

ISCO$iscoGroup <- as.numeric(ISCO$iscoGroup)

ISCO$iscoGroup <- recode(ISCO$iscoGroup, `1` = "Managers", `2` = "Professionals", `3` = "Technicians and associate professionals", `4` = "Clerical Support Workers", `5` = "Service and sales workers", `6` = "Skilled agricultural, forestry and fishery workers", `7` = "Craft and related trades workers", `8` = "Plant and machine operators, and assemblers", `9` = "Elementary occupations", `10` = "Armed forces occupations")

job_groups <- table(ISCO$iscoGroup) #table of first level of ISCO classifications for all participants

#1 (Managers): 51
#2 (Professionals): 120
#3 (Technicians and associate professionals): 62
#4 (Clerical support workers): 4
#5 (Service and sales workers): 8
#6 (Skilled agricultural, forest and fishery workers): 0
#7 (Craft and relate trades workers): 1
#8 (Plant and machine operators and assemblers): 3
#9 (Elementary occupations): 0
#0 (Armed forces occupations): 0

# I can't figure out how to merge this with the original dataframe because classify_occupation doesn't output an ID column that matches
# the original row number in together... for some reason. Either way this table gets the job done. Lesson learned: free text entry is bad

###### Tenure
#Result of manual coding
together$tenure <- c(0.5,7,2.5,0.5,0.83,14,3,3,5,2,2,12,3,1.5,5,1,5,1,3,20,1.5,NA,8,2,NA,4,2,4,1.08,5,15,3.5,
                     20,15,0.66,2,12.5,15,7,1.5,5,7,3.5,0.25,NA,15,NA,2,3,38,9,NA,2,1,NA,NA,1,0.20,NA,NA,2,
                     0.5,NA,NA,5,2,1,2,1.5,3,3,2,1.5,0.25,NA,1,NA,3,NA,3,1,5,0.83,1.5,0.08,16,4,2,9,11,8,
                     0.75,NA,4,3,4.5,NA,1.5,4,3,0.33,3,0.5,3,6.5,17,1,21,14,3,7,1,17,2.5,33,32,11,9,NA,2,3,1.5,1,NA,2.5,NA,NA,NA,NA,
                     NA,NA,NA,3,18,NA,2.5,NA,9,NA,8,15,12,2.5,20,2.5,17,10,20,6.5,6,1,10,2,0.83,6,0.33,8,1.16,
                     4,5,6,10,1.5,2,17,14,30,0.16,4,3,1,20,0.16,40,3,1,12,3.5,2.25,10,22,1,31,41,16,NA,35,
                     0.5,4,2.5,30,2,NA,4,2,NA,3,8,2,0.5,5,2.5,3,1.5,NA,0.33,4,NA,2,3,4,27,1.5,4,6,4,22,1.7,2,1.5,3.5,0.41,
                     7,6,1,0.08,1.5,7,0.41,4,2.5,2,2,12,7,0.66,NA,3,10,0.33,15,33,30,23,2,0.33,35,6,7,1,3,2,
                     1,3,10,NA,30,0.16,7,6,5,2,3,NA,NA,NA,4,2.5,4,NA,1.41,3,NA,NA,25,2,12,12,1.2,8,1.5,1
)

#creates demographic table using DT library

demo_table <- together %>% 
  select(`How many hours do you typically work per week in this job?`, tenure, 
         `What is the title of the job you were thinking about while responding to this survey?`) %>% 
  filter_all(any_vars(!is.na(.))) %>% #changed DT to filter out rows where all col values == NA
  datatable()

colnames(together)[39] <- "hours"     ## label too long

```

## Participants

`r num` individuals provided ratings across 36 candidate items. These participants were gathered via snowball sampling, with an initial population of undergraduate and graduate students, as well as professional acquaintances of faculty members.` All surveys were administered on Qualtrics.

Participant job title, hours worked per week, and organizational tenure were recorded. Mean hours worked per week was `r mean(together$hours, na.rm=TRUE)` (SD = `r sd(together$hours, na.rm=TRUE)`). Mean organizational tenure was `r mean(together$tenure, na.rm = TRUE)` (SD = `r sd(together$tenure, na.rm = TRUE)`). Participants who did not exactly specify their tenure (e.g. "A bit over a year") were not included in this average.

```{r hours, echo=FALSE, warning=FALSE, fig.cap="Distribution of mean hours worked per week",include=FALSE}

hours_hist <- ggplot(together) +
  geom_histogram(aes(x = hours)) +
  xlab("Hours worked per week") +
  ylab("Number of responses") +
  theme_apa() +
  ggtitle("How many hours do you typically work per week in this job?")

hours_hist
```

```{r tenure, echo=FALSE, warning=FALSE, fig.cap="Distribution of organizational tenure (years)", include=FALSE}
tenure_hist <- ggplot(together) +
  geom_histogram(aes(x = tenure)) + 
  xlab("Organizational tenure (years)") +
  ylab("Number of responses") +
  ggtitle("How long have you been with this organization?") +
  theme_apa()

tenure_hist
```

```{r job_table, fig.cap="ISCO professional categories of participants", include=FALSE}
job_table <- knitr::kable(job_groups, col.names = c("Professional category", "Count"))
job_table
```

Participants provided their job titles via an optional free text-entry box at the end of the survey. From there, we classified job titles according to the International Standard Classification of Occupations (ISCO-8) with the `classify_occupation` function within the `labourR` package (@R-labourR). The ISCO hierarchically organizes jobs in increasing order of specificity. For example, the first level of the hierarchy distinguishes a professional from a clerical worker or a technician. On the second level, professionals are distinguished among each other by whether they are engineers, medical workers, lawyers, and so on. According to this classification, 120 of our participants were professionals, 51 were managers, 4 were clerical support workers, 3 were plant and machine operators, and 1 was a trade worker.

### Item generation

We generated a set of 50 items for our engagement measure, with the ultimate goal of reducing them to a final set of 18. Each item was worded to reflect both a substantive dimension as well as an attitudinal dimension. For example, the item "My job makes me feel like I'm part of something meaningful" reflects the affective dimension with "feel" and the dedication dimension with "I'm part of something meaningful." Our 3x3 bifactor model produced nine pairs of dimensions (e.g., Vigor-Cognitive, Vigor-Affective, Vigor-Behavioral, etc.). With 36 initial items, this left four items per pair of substantive and attitudinal dimensions.

### Content validation and initial item reduction

An item sorting process was conducted to ensure content validity of our scale. Our original 50 items were presented to seven masters and PhD students in industrial-organizational psychology at Montclair State University, with each student instructed to sort each item into its respective substantive and attitudinal dimensions. Items that were not sorted into the same substantive-attitudinal dimension pair (e.g. vigor-cognitive) by at least five of seven raters were excluded from further analysis.

Following item sorting, we further reviewed the wording of each item and eliminated all that, upon review, fell outside of the content domain (e.g. “I would rather work here than elsewhere”), eventually arriving at 36 candidate items.

## Procedure

> Looking into the specification of polychoric covariances [@joreskog1994estimation]. This seems to be not very commonly leveraged (only package that seems to estimate these is `semPlot`).

The effective result of this was two divergent quasi-experimental approaches: 1) focus on corrected item-total correlations, and 2) focus on CFA modification indices.

### Corrected item-total correlations

> Casey uses "r.drop" and "corrected item-total correlations" as though they're different. Is there a distinction worth mentioning in this paper?

Using the `alpha` function from the `psych` package, we recorded corrected item-total correlations for each of our 36-item set. For each set of four items per substantive-attitudinal pair, we removed the item with the lowest corrected item-total correlation from the model, leaving three items per dimension pair. We then re-ran `alpha` upon our model and repeated this process, leaving only two items per substnative-attitudinal pair, i.e., 18 remaining items.

We conducted a correct item-total correlation on our original 36-items set. Based off the r. drops that the corrected item-total correlations provide us we narrowed it down by selecting that items that had the best r. drops off removing one item at a time. For example, each cell division contain 4 items, therefore, we remove one of the four items creating 6 potential 3 item corrected item correlations, and from there we choose the items with the best r. drops. We continued the same process when narrowing our three items down to two items. An example is shown below:

### CFA Modification Indices

We followed two parallel stepwise item-reduction processes centered around eliminating items in decreasing order of modification indices. Looking at the 36-item substantive and attitudinal models independently (process 1 and process 2), we requested modification indices from each, with the intent of retaining indicators whose fixed shared residual covariances were associated with high modification indices (indicating better model fit if the paths were freed). The item pair with the highest modification index was scrutinized, with a subjective group judgment made on wording and content domain coverage. The less preferred item was removed from the model. In cases where the highest modification index was between the only two remaining items in a substantive-attitudinal pair, these items were passed over for scrutiny in favor of the items with the next-highest index. This process was repeated until 18 items remained (i.e., 2 items for each of the 9 substantive-attitudinal pairs).

For example, the path with the highest modification index across both CFAs was between item 2 and item 4, which are both indicators of "Absorption" and "Cognition". One of these items was therefore a candidate for deletion, and semantic preference was given to item 4, "I find it difficult to mentally disconnect from work" over item 2. After item 2 was excluded from both scale definitions (substantive and attitudinal), the CFAs were re-run and modification indices re-checked for bi-factor structure optimizing modifications.[^2]

[^2]: Probably put a table in here highlighting certain modification indices (with a key to intended factor-item association). Look at "modincides1"

The end result was two separate final scale definitions (one optimized for the substantive model and one for the attitudinal model).

> Old text: We prioritized item deletions such that an item was implicated for deletion if: 1) modification index was high (relative to others) and 2) error residual was within the same "cell". The choice of item to delete was based on author preference for wording/semantics as well as construct element coverage (considering the possible consequences for construct deficiency). Item variance was also consulted (retention more likely with greater item variance).

```{r modindices, fig.cap="Sample modification index table"}

#figure out how to display this in the middle of the paper rather than a figure at the end of the paper  

mod <- data.frame(read.csv('att.csv', row.names = NULL)[1:7, 2:5])
mod2 <- mod[,-2]
mod2$Notes <- c("Candidate for deletion due to construct duplication", "", "Candidate for retention due to substantive construct association", "", "", "", "")

colnames(mod2) <- c('Element 1', 'Element 2', "Modification Index", "Notes") #Δχ2 isn't showing up properly in knit output. Fix.

mod <- apa_table(mod2, caption = "Attitudinal structure modification indices (36 item analysis)")
mod

#, align = c("m{2cm}","m{2cm}","m{2cm}","m{7cm}")
```

> > Actually it doesn't matter that much with only 1 item deletion - probably go ahead and do a few before recheck modification indices

### Single factor versus bifactor approaches

> Casey this is where you come in

## Data analysis

We used `r cite_r("r-references.bib")` for all analyses.

# Results

CFA drafts below

```{r CFAsub, echo=FALSE, warning=FALSE, fig.cap="Substantive factor structure CFA"}

## getting conditions into one large file below - 12/9/20

data$Cond1 <- rowSums(is.na(data[18:53]))
data$Cond2 <- rowSums(is.na(data[54:89]))
data$Cond3 <- rowSums(is.na(data[90:125]))
data$Cond4 <- rowSums(is.na(data[126:161]))

data$Condition[data$Cond1 < 36] <- 1
data$Condition[data$Cond2 < 36] <- 2
data$Condition[data$Cond3 < 36] <- 3
data$Condition[data$Cond4 < 36] <- 4

cond1 <- data[ which(data$Condition==1), ]
cond2 <- data[ which(data$Condition==2), ]
cond3 <- data[ which(data$Condition==3), ]
cond4 <- data[ which(data$Condition==4), ]

cond1.red <- cond1[,c(6, 18:53, 162:165, 171)]  ## using Cond1 ordering
cond2.red <- cond2[,c(6, 62:65, 70:73, 82:85, 58:61, 74:77, 86:89, 66:69, 78:81, 54:57, 162:165, 171)]
cond3.red <- cond3[,c(6, 94:97, 106:109, 118:121, 98:101, 110:113, 122:125, 102:105, 114:117, 90:93, 162:165, 171)]
cond4.red <- cond4[,c(6, 138:161, 130:137, 126:129, 162:165, 171)]        ## 171 versus 172 because testing script has extra "hours" variable

names(cond1.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond1.red))      ## Getting rid of condition markers so rbind will work
names(cond2.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond2.red))  
names(cond3.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond3.red))  
names(cond4.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond4.red))  

together <- rbind(cond1.red, cond2.red, cond3.red, cond4.red)        ## we'll be using this object for analyses

num_valid <- nrow(together)

i <- c(1:37)                                          ## Changing item responses to numerics
together[ , i] <- apply(together[ , i], 2,            # Specify own function within apply
                        function(x) as.numeric(as.character(x)))


##########################################################
##########################################################
##########################################################
############# RECODES

together$`Most days, I feel happiest when the workday is soon to be complete.` <- 7 - together$`Most days, I feel happiest when the workday is soon to be complete.`
together$`This job drains my energy.` <- 7 - together$`This job drains my energy.`

## BEHAVIORAL (NONE):

## COGNITIVE: 

together$`Thinking about work saps my energy.` <- 7 - together$`Thinking about work saps my energy.`
together$`I often think about finding another job.` <- 7 - together$`I often think about finding another job.`


library(lavaan)
library(sem)
library(semPlot)
library(dplyr)
 

CFAdata<-together[,2:37]


CFAdata<-CFAdata%>%rename(
  Item_1=`Iâ€™m able to concentrate on my work without distractions.`,
  Item_2=`I have a hard time detaching mentally from my work.`,
  Item_3=`Time passes quickly while Iâ€™m working.`,
  Item_4=`I find it difficult to mentally disconnect from work.`,
  Item_5=`I enjoy thinking about work even when Iâ€™m not at work.`,
  Item_6=`Most days, I feel happiest when the workday is soon to be complete.`,
  Item_7=`I am happiest when I am immersed in a project.`,
  Item_8=`I love starting my workday.`,
  Item_9=`I devote more time than is expected of me.`,
  Item_10=`I have to be reminded to take breaks while Iâ€™m at work.`,
  Item_11=`I never miss a work deadline.`,
  Item_12=`I never allow distractions to interfere with my work.`,
  Item_13=`I devote my full attention to my work tasks throughout the day.`,
  Item_14=`Thinking about work saps my energy.`,
  Item_15=`I would rather direct my focus toward a work task than a personal task.`,
  Item_16=`Iâ€™m able to maintain good levels of energy throughout the workday.`,
  Item_17=`I enjoy spending time completing my job tasks.`,
  Item_18=`Most days I feel enthusiastic about starting my work day.`,
  Item_19=`I feel motivated to go beyond what is asked of me.`,
  Item_20=`This job drains my energy.`,
  Item_21=`When work is slow I find ways to be productive.`,
  Item_22=`I express enthusiasm for my job while at work.`,
  Item_23=`I try my best to perform well at work.`,
  Item_24=`If I notice my energy level is low, I take corrective steps to re-energize.`,
  Item_25=`I plan my future with this company.`,
  Item_26=`I believe this company cares about my career goals.`,
  Item_27=`I often think about finding another job.`,
  Item_28=`This organization challenges me to work at my full potential.`,
  Item_29=`I am proud to be a member of this organization.`,
  Item_30=`I feel supported by my supervisor when I fail at a task.`,
  Item_31=`I feel proud of my accomplishments within this organization.`,
  Item_32=`My job makes me feel like Iâ€™m part of something meaningful.`,
  Item_33=`I make valued contributions to the organization.`,
  Item_34=`I embrace challenging situations at work.`,
  Item_35=`I speak positively about this organization to others.`,
  Item_36=`This organization provides the resources necessary for me to successfully perform my job.`
)




```

```{r CFAatt1, echo=FALSE, warning=FALSE, fig.cap="Substantive factor measurement model"}
Sub_Model<-'
Absorption = ~Item_1 + Item_3  + Item_5  + Item_8  + Item_10 + Item_11
Vigor      = ~Item_14 + Item_16 + Item_17 + Item_19 + Item_21 + Item_22
Dedication = ~ Item_26 + Item_28 + Item_31 + Item_32 + Item_34 + Item_35
'

Fit1.1<-lavaan::cfa(Sub_Model, data = CFAdata)
# semPlot::semPaths(Fit1.1, "std")

semPlot::semPaths(Fit1.1, what="std", sizeLat=10, style="lisrel",
              sizeMan=4.5,edge.label.cex=0.75, edge.color="black", asize=2, rotation=4)


# summary(Fit1.1, fit.measure=TRUE)

# write.csv(modindices(Fit1.1, sort=TRUE), "fit_substantive.csv")
```

```{r CFAatt2, echo=FALSE, warning=FALSE, fig.cap="Attitudinal factor measurement model"}


Att_Model<-'
Cognitive  = ~Item_1  + Item_3  + Item_14 + Item_16 + Item_26 + Item_28
Affective  = ~Item_5 +  Item_8  + Item_17 + Item_19 + Item_31 + Item_32
Behavioral = ~Item_10 + Item_11 + Item_21 + Item_22 + Item_34 + Item_35
'
Fit1.2<-lavaan::cfa(Att_Model, data = CFAdata)
semPlot::semPaths(Fit1.2,what="std", sizeLat=10, style="lisrel",
              sizeMan=4.5,edge.label.cex=0.75, edge.color="black", asize=2, rotation=2)
# lavaan::fitMeasures(Fit1.2)
# summary(Fit1.2, fit.measure=TRUE)

```

```{r CFAatt3, echo=FALSE, warning=FALSE, fig.cap="Bifactor measurement model"}

modified2 <-'
Absorption = ~Item_1 + Item_3  + Item_5  + Item_8  + Item_10 + Item_11
Vigor      = ~Item_14 + Item_16 + Item_17 + Item_19 + Item_21 + Item_22
Dedication = ~ Item_26 + Item_28 + Item_31 + Item_32 + Item_34 + Item_35
Cognitive  = ~Item_1  + Item_3  + Item_14 + Item_16 + Item_26 + Item_28
Affective  = ~Item_5 +  Item_8  + Item_17 + Item_19 + Item_31 + Item_32
Behavioral = ~Item_10 + Item_11 + Item_21 + Item_22 + Item_34 + Item_35
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor      ~~ 0*Affective
Vigor      ~~ 0*Behavioral
Vigor      ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'

Fit.mod2 <- lavaan::cfa(modified2, data = CFAdata, missing = "ML", estimator = 'MLR')

# semPlot::semPaths(Fit.mod2, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
#                  rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0, pastel=FALSE)

semPlot::semPaths(Fit.mod2, bifactor = c("Cognitive", "Affective", "Behavioral"), style="lisrel", "std", layout = "tree3", sizeLat=10, rotation = 2, sizeMan=4.5,edge.label.cex=0.75, edge.color="black", asize=2)


# modindices(Fit.mod2, sort = TRUE, maximum.number = 25)

# summary(Fit.mod2, standardized=TRUE)

```

```{r fitmeasures}

# into data frames
fit1.1 <- as.data.frame(fitMeasures(Fit1.1))
fit1.1$`fitMeasures(Fit1.1)` <- round(fit1.1$`fitMeasures(Fit1.1)`, 2)

fit1.2 <- as.data.frame(fitMeasures(Fit1.2))
fit1.2$`fitMeasures(Fit1.2)` <- round(fit1.2$`fitMeasures(Fit1.2)`, 2)

fit.mod2 <- as.data.frame(fitMeasures(Fit.mod2))
fit.mod2$`fitMeasures(Fit.mod2)` <- round(fit.mod2$`fitMeasures(Fit.mod2)`, 2)

indices_att <- as.data.frame(t(fit1.1[c(3,4,23,29,9,10,19),]))        ## Chi-sq, df, RMSEA, SRMR, CFI, TLI, AIC
indices_sub <- as.data.frame(t(fit1.2[c(3,4,23,29,9,10,19),]))
indices_bi <- as.data.frame(t(fit.mod2[c(3,4,44,58,17,18,38),]))

fits <- rbind(indices_att, indices_sub, indices_bi)
names(fits) <- c("Chi Square", "df", "RMSEA", "SRMR", "CFI", "TLI", "AIC")
model <- c("Attitudinal", "Substantive", "bifactor")
fits2 <- cbind(model, fits)

apa_table(fits2, caption = "Summary fit statistics (18 item proposed scale definitions)")

```

## Final scale definitions

> currently the table uses the twenty-item scale definition

```{r final, fig.cap="Final scale definition"}
#This is the TWENTY ITEM scale definition

item_number <- seq(1:36)

text <- c("I am able to concentrate on my work without distractions.",
"I have a hard time detaching mentally from my work.",
"Time passes quickly while I'm working.",
"I find it difficult to mentally disconnect from work.",
"I enjoy thinking about work even when I'm not at work.",
"Most days, I feel happiest when the workday is soon to be complete.",
"I am happiest when I am immersed in a project.",
"I love starting my workday.",
"I devote more time than is expected of me.",
"I have to be reminded to take breaks while I'm at work.",
"I never miss a work deadline.",
"I never allow distractions to interfere with my work.",
"I devote my full attention to my work tasks throughout the day.",
"Thinking about work saps my energy.",
"I would rather direct my focus toward a work task than a personal task.",
"I'm able to maintain good levels of energy throughout the workday.",
"I enjoy spending time completing my job tasks.",
"Most days I feel enthusiastic about starting my work day.",
"I feel motivated to go beyond what is asked of me.",
"This job drains my energy.",
"When work is slow I find ways to be productive.",
"I express enthusiasm for my job while at work.",
"I try my best to perform well at work.",
"If I notice my energy level is low, I take corrective steps to re-energize.",
"I plan my future with this company.",
"I believe this company cares about my career goals.",
"I often think about finding another job.",
"This organization challenges me to work at my full potential.",
"I am proud to be a member of this organization.",
"I feel supported by my supervisor when I fail at a task.",
"I feel proud of my accomplishments within this organization.",
"My job makes me feel like I'm part of something meaningful.",
"I make valued contributions to the organization.",
"I embrace challenging situations at work.",
"I speak positively about this organization to others.",
"This organization provides the resources necessary for me to successfully perform my job."
)

substantive <- c(rep("Absorption", 12), rep("Vigor", 12), rep("Dedication", 12))
attitudinal <- rep(c(rep("Cognitive", 4), rep("Affective", 4), rep("Behavioral", 4)),3)
final <- c("Included",
"Excluded",
"Included",
"Included",
"Included",
"Excluded",
"Excluded",
"Included",
"Excluded",
"Included",
"Included",
"Excluded",
"Excluded",
"Included",
"Excluded",
"Included",
"Included",
"Excluded",
"Included",
"Excluded",
"Included",
"Included",
"Excluded",
"Excluded",
"Included",
"Included",
"Excluded",
"Included",
"Excluded",
"Excluded",
"Included",
"Included",
"Excluded",
"Included",
"Included",
"Excluded"
)

item_table <- data.frame(item_number, text, substantive, attitudinal, final)
item_table <- papaja::apa_table(item_table)
item_table
```



## Study 2

Construct validation was accomplished via administration of the 17-item UWES as well as the @saks2006antecedents 12-item scale. @saks2006antecedents aggregates to two scales: job and organizational engagement.

# Discussion

The purpose of this study was to present two divergent approaches for constructing scales that simultaneously probe the substantive and attitudinal factor structures of employee engagement.

Our next endeavor will be to establish convergent and discriminant validity of ourr scale

Currently, the UWES is one of the most popular engagement scales
Our proposed scale would 

Bifactor analysis may be a valuable method of reconciling previously at-odds approaches to describing the same construct.

Our research contributes to theory in two key ways. Firstly, it introduces a novel measure of engagement, developed in English, that will allow future researchers to further probe the tripartite attitudinal structure of the construct. To our knowledge, ours is the only engagement scale that probes the specific attitudinal dimensions of engagement.

> Is the term for our specific flavor of bifactor analysis "unconstrained non-hierarchical bifactor analysis"?

Secondly, we more generally advance the use of bifactor analysis as an alternative approach to testing and comparing structural models of constructs. 

We show that a scale can exhibit high internal consistency while simultaneously measuring two different structural models.
It is our hope that the success of this approach might evangelize bifactor analysis and the more general approach of consolidating and integrating theories rather than parsing them.


\newpage

# References

```{=tex}
\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}
```
::: {#refs custom-style="Bibliography"}
:::

\endgroup
