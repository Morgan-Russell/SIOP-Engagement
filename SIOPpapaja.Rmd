---
title             : "Development of an Intended Bifactor Engagement Measure"
shorttitle        : "BiFactor Engagement"

author: 
  - name          : "Morgan Russell"
    affiliation   : "1"
    corresponding : yes    # Define only one corresponding author
    address       : "1 Normal Ave, Montclair, NJ 07043"
    email         : "russellm5@montclair.edu"
  - name          : "Casey Osorio-Duffoo"
    affiliation   : "2"
  - name          : "Renata Garcia Prieto Palacios Roji"
    affiliation   : "1"
  - name          : "John Kulas"
    affiliation   : "1"

affiliation:
  - id            : "1"
    institution   : "Montclair State University"
  - id            : "2"
    institution   : "Harver"

authornote: |
  Title: 85 characters;
  Abstract: 600 characters
  Word count: 3,000 words
  Remove names

abstract: |
  Employee engagement has enjoyed a surge in interest as a sought-after attitude despite continued disageement regarding its internal structure and nomological relationship to other constructs, such as satisfaction and burnout. We describe the development of an intentional bi-factor measure of engagement, and document two independent scale definition procedures, one based on internal consistency and the other informed by CFA modification indices. Ultimately, we arrive at scale definitions that should be considered of interest to Industrial and Organizational Psychologists.
  
keywords          : "Engagement, bifactor analysis"
wordcount         : "X"

bibliography      : ["r-references.bib", "engage.bib", "siopadds.bib", "bifactor.bib", "book.bib", "renata.bib"]

floatsintext      : no 
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no
numbersections    : no

csl               : "apa7.csl"
documentclass     : "apa7"
classoption       : "man"
output            : papaja::apa6_word
---

```{r setup, include = FALSE}
library("papaja")
r_refs("r-references.bib")
```

```{r analysis-preferences}
# Seed for random number generation
set.seed(42)
knitr::opts_chunk$set(cache.extra = knitr::rand_seed, echo=FALSE, warning=FALSE, message=FALSE)

```

Within the context of work, the term "engagement" first emerged in the organizational psychology and business literature in the early 1990s [@kahn1990psychological]. The evolution of the construct can perhaps be considered through the lens of semi-distinct lines of research focused on: 1) work engagement, 2) personal engagement, and 4) employee engagement, and 4) burnout. These perspectives can be identified by slightly differing definitions (and subsequently measures), and perhaps contribute to some confusion regarding what exactly is being measured when organizations survey their employees to assess "engagement". Although "personal engagement" was coined in @kahn1990psychological , few subsequent articles reference engagement by this name. @schaufeli2013engagement distinguishes work engagement from employee engagement on the basis of their referent: "Work engagement refers to the relationship of the employee with his or her *work*, whereas employee engagement may also include the relationship with the *organization*".

The current project is most closely aligned with the *work engagement* tradition, whose most frequently-cited definition of engagement is "the positive, fulfilling, work-related state of mind that is characterized by vigor, dedication, and absorption. Vigor is characterized by high levels of energy and mental resilience while working. Dedication refers to being strongly involved in one's work and experiencing a sense of significance, enthusiasm, inspiration, pride, and challenge. Absorption is characterized by being fully concentrated and happily engrossed in one's work, whereby time passes quickly and one has difficulties with detaching oneself from work" [@schaufeli_measurement_2002; p. 74].

The nomological relationship of engagement to burnout has been the source of no small amount of debate. One school of thought contends that burnout is the opposite of engagement and resides on the antipode of the engagement spectrum, while others argue that engagement is a distinct construct entirely. Some credence is lent to the former claim by the fact that measures of burnout and engagement tend to show moderate negative correlations [@schaufeli2003utrecht]. More recently, more sophisticated factor analysis found that a single factor did not adequately explain variance in both burnout and engagement, suggesting that they are nomologically distinct [@trogolo2020work]. We also align with the claim that burnout and engagement are related but separable constructs and do not explicitly explore their relationship in this study.

## Why engagement?

Even in the presence of rampant disagreement about the nature of engagement, interest in the construct still abounds. This is likely fueled in large part by its relationships with many other desirable workplace constructs. At the employee level, engagement has been found to relate to organizational commitment [@hanaysha2016testing], job satisfaction [@alarcon2011relationship], and job performance [@rich2010job]. Some lines of study also frame engagement as a positive counterpoint to workaholism[@caesens2014impact], particularly in an occupational health context [@girardi2019workaholism]. Such research testifies not only to the value of engagement as both an predictor and outcome in itself, but also to the enthusiasm of academics and practitioners for further understanding the role engagement at work. In light of this, it is all the more important to better understand the structure of this construct to support future research.

> old paragraph

> Across the literature appear different trends in work engagement research, such as studying work engagement as a phenomenon that fluctuates within individuals, episodic work engagement, organizational-level work engagement, and leadership and work engagement. A relevant topic in recent literature is how dynamic work engagement can be. Bakker and colleagues (2018) point out that for organizational practice, it is important to understand that employees experience fluctuating levels of engagement at work and what causes these fluctuations (e.g., culture, environment, leadership, etc.). Although it is important that research continues to improve our understanding of the nature, causes, and outcomes of engagement, it is also important that this knowledge is transferred to practical applications that can benefit both individuals and organizations. An important aspect of accumulating knowledge on the subject is the methodological component of how that knowledge is built.

## Our Proposed Model of Engagement

> KULAS: Bifactor as method to clean up sub-scale associations

Like many other constructs within the psychology literature, our knowledge of work engagement has been at least partially informed by its measurement and linkage to other work attitudes and behaviors. There are currently many work engagement scales used for either academic or applied purposes (and sometimes both), which extract work engagement scores at the individual level. Most of these scales are measuring latent constructs that are not work engagement per se, but are intended to capture elements of this construct through indicators of other latent constructs. For example, the idea that vigor, dedication, and absorption together form the foundation of work engagement forms the basis of the Utrecht Work Engagement Scale (UWES; Schaufeli et al., 2002). Despite its wide use and recognition, the UWES has been subject to criticism due to its development methodology and factorial structure [@willmer_exploratory_2019]. A central criticism is that the three subscales; vigor, dedication, and absorption, are closely correlated with each other, making it hard to argue that the three-factor structure is better than the single factor structure to measure work engagement [@kulikowski_we_2017]. However, the UWES is still a widely used measure and its subscales are used to identify the specific subcategories of work engagement that need improvement. Given their popularity, the subscales within this theoretical framework are used as the first theoretical model for this project (see Figure 1).

## Engagement as an attitude

The first definition of "engagement" in a work context was offered by @kahn1990psychological: "the harnessing of organization members' selves to their work roles; in engagement, people employ and express themselves physically, cognitively, and emotionally during role performances." Although this definition was quickly outrun by ensuing contributors (see, for example, @baumruk2004missing and @shaw2005engagement, who framed it in terms of one's cognitive and affective *commitment* to one's organization), @kahn1990psychological's definition is notable in that it is inspired by the then-ascendant tripartite model of attitudes. This model is usually attributed to @rosenberg_cognitive_1960 and proposes that attitudes can be deconstructed into cognitive, affective, and behavioral components [@kaiser_campbell_2019]. Even though it is not specifically a work engagement model, the tripartite model has helped researchers define and deconstruct attitudes to gain a better understanding of individuals' responses towards specific attitude objects (@kaiser_campbell_2019).

## Bifactor structures

Bifactor analysis is most commonly used to investigate shared variance in observed variables that extend beyond the effects accounted for by the intended latent structure [@giordano_exploratory_2020]. In most applications the latent constructs included in bifactor models are mutually orthogonal (i.e., uncorrelated), and represent the broad target constructs an instrument was designed to measure. Bifactor models are best suited to represent the multidimensionality arising from item responses that aim to measure broader constructs through multiple domains or subcategories [@reise_rediscovery_2012]. Additionally, these models can be classified as constrained hierarchical bifactor models and unconstrained non-hierarchical bifactor models [@giordano_exploratory_2020]. For the purposes of this project, an unconstrained non-hierarchical model is used to determine which group factors represent substantive and attitudinal constructs. The resulting general factors in the non-hierarchical model have a direct (i.e., non-mediated) relationship with each variable observed. In this case, each general factor from both the substantive and attitudinal models have non-mediated but overlapping effects on each variable.

# Methods

Informed by the @schaufeli_measurement_2002 definition of engagement we conceptualize engagement as a mental state wherein employees feel energized, are enthusiastic about the content of their work and the things they do, and are so immersed in their work activities that time seems compressed. Furthermore, we approach our measurement of these engagement domains through the lens of an attitude and generate indicators that are indicative of cognitive, affective, and behavioral attitudinal components. Although by tradition, item complexity has been considered something to avoid, we eagerly embraced this complexity - both for the methodological extension of bifactor approaches as well as the potential to account for inter-domain associations of engagement measures previously viewed as a nuisance.

## Item generation

From our construct definitions, we generated an initial set of 50 candidate items, with the ultimate goal of reducing them to a final set of 18 (two items per bifactor). Each item was sampled from two content domains: one substantive (Vigor, Dedication, or Absorption) and one attitudinal (cognitive, affective, or behavioral). For example, the item "My job makes me feel like I'm part of something meaningful" is intended to reflect the affective component of dedication.

### Content validation and initial item reduction

The 50 candidate items underwent two rounds of content validation and subsequent revision by teams of graduate students and faculty. The first sorting process was conducted by seven masters' and PhD students in Industrial-Organizational Psychology, with each student provided content domain definitions and instructions to place each item into its substantive as well as attitudinal dimension (i.e., each item was sorted *twice*). Items that were not sorted into the same dimension by at least five of the seven raters were deemed candidates for revision or deletion. The instrument authors reviewed the wording of these items and eliminated 14 that could not be salvaged. Most revisions entailed strengthening the attitudinal component of the item (that is, our content validity exercises exhibited the most rater disagreement along the attitudinal content domains). A final content validation was undertaken by three graduate students and a faculty member who sorted the 36 items into one of nine domains (e.g., Vigor-Affect, Dedication-Behavior, etc.). Any disagreement at this stage was resolved through a final round of minor item editing.

```{r getData, echo=FALSE, warning=FALSE}
#PASTED CURRENT VERSION OF 'MORGAN JOB TITLE HOURS WORKED'
#KEEP UP TO DATE
# Morgan factorizes the "What is the title of the job you were thinking about while responding to this survey?" column
# As well as the "How many hours do you typically work per week in this job?" column

# An object lesson in why you should NEVER HAVE FREE TEXT ENTRY IN YOUR SURVEY


# Packages
library(tidyverse)
library(DT)
library(labourR)
library(apaTables)


temp <- read.csv("qualtrics_pilot_data.csv", header=FALSE, na.strings="")

x <- temp[2,]
data <- temp[-c(1:3),]
colnames(data) <- x

num <- nrow(data)

## getting conditions into one large file below - 12/9/20

data$Cond1 <- rowSums(is.na(data[18:53]))
data$Cond2 <- rowSums(is.na(data[54:89]))
data$Cond3 <- rowSums(is.na(data[90:125]))
data$Cond4 <- rowSums(is.na(data[126:161]))

data$Condition[data$Cond1 < 36] <- 1
data$Condition[data$Cond2 < 36] <- 2
data$Condition[data$Cond3 < 36] <- 3
data$Condition[data$Cond4 < 36] <- 4

cond1 <- data[ which(data$Condition==1), ]
cond2 <- data[ which(data$Condition==2), ]
cond3 <- data[ which(data$Condition==3), ]
cond4 <- data[ which(data$Condition==4), ]

cond1.red <- cond1[,c(6, 18:53, 162:165, 171)]  ## using Cond1 ordering
cond2.red <- cond2[,c(6, 62:65, 70:73, 82:85, 58:61, 74:77, 86:89, 66:69, 78:81, 54:57, 162:165, 171)]
cond3.red <- cond3[,c(6, 94:97, 106:109, 118:121, 98:101, 110:113, 122:125, 102:105, 114:117, 90:93, 162:165, 171)]
cond4.red <- cond4[,c(6, 138:161, 130:137, 126:129, 162:165, 171)]        ## 171 versus 172 because testing script has extra "hours" variable

names(cond1.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond1.red))      ## Getting rid of condition markers so rbind will work
names(cond2.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond2.red))  
names(cond3.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond3.red))  
names(cond4.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond4.red))  

together <- rbind(cond1.red, cond2.red, cond3.red, cond4.red)        ## we'll be using this object for analyses

# Hours worked
together$`How many hours do you typically work per week in this job?` <- together$`How many hours do you typically work per week in this job?` %>% 
  gsub("[^0-9./-]", "", .) %>%  # removes all characters not included in brackets
  gsub(".*/", "", .) %>% # Selects second number after "/" (e.g. 40/50 -> 50)
  gsub(".*-", "", .) %>%  # Selects second number after "-" (e.g. 50-60 -> 60)
  gsub("[^0-9]", "", .) %>%
  str_sub(1,2) %>% # Subsets all responses to first two indices. Quick and easy way to rule out impossible hour entries
  as.numeric()

#Job title

#creates new column 'position' detecting presence of keywords. To create new search terms, copy the "str_detect" line
together <- together %>% 
  mutate_at(vars(`What is the title of the job you were thinking about while responding to this survey?`), 
            list(position =~ case_when(str_detect(., regex("account"))~"accountant",
                                       str_detect(., regex("analy"))~"analyst",
                                       TRUE~.)))

together$position <- together$`What is the title of the job you were thinking about while responding to this survey?` %>% 
  tolower() %>% 
  trimws()

#ESCO/ISCO classification using the labourR package
#ISCO = International Standard Classification of Occupations

together$id <- 1:nrow(together) #adds unique identifier to satisfy inane requirement of classify_occupation()

ISCO <- classify_occupation(together, text_col = 'position', isco_level = 1) #nrow = 249 (I think BC it ignores NA's?)

ISCO$iscoGroup <- as.numeric(ISCO$iscoGroup)

ISCO$iscoGroup <- recode(ISCO$iscoGroup, `1` = "Managers", `2` = "Professionals", `3` = "Technicians and associate professionals", `4` = "Clerical Support Workers", `5` = "Service and sales workers", `6` = "Skilled agricultural, forestry and fishery workers", `7` = "Craft and related trades workers", `8` = "Plant and machine operators, and assemblers", `9` = "Elementary occupations", `10` = "Armed forces occupations")

job_groups <- table(ISCO$iscoGroup) #table of first level of ISCO classifications for all participants

#1 (Managers): 51
#2 (Professionals): 120
#3 (Technicians and associate professionals): 62
#4 (Clerical support workers): 4
#5 (Service and sales workers): 8
#6 (Skilled agricultural, forest and fishery workers): 0
#7 (Craft and relate trades workers): 1
#8 (Plant and machine operators and assemblers): 3
#9 (Elementary occupations): 0
#0 (Armed forces occupations): 0

# I can't figure out how to merge this with the original dataframe because classify_occupation doesn't output an ID column that matches
# the original row number in together... for some reason. Either way this table gets the job done. Lesson learned: free text entry is bad

###### Tenure
#Result of manual coding
together$tenure <- c(0.5,7,2.5,0.5,0.83,14,3,3,5,2,2,12,3,1.5,5,1,5,1,3,20,1.5,NA,8,2,NA,4,2,4,1.08,5,15,3.5,
                     20,15,0.66,2,12.5,15,7,1.5,5,7,3.5,0.25,NA,15,NA,2,3,38,9,NA,2,1,NA,NA,1,0.20,NA,NA,2,
                     0.5,NA,NA,5,2,1,2,1.5,3,3,2,1.5,0.25,NA,1,NA,3,NA,3,1,5,0.83,1.5,0.08,16,4,2,9,11,8,
                     0.75,NA,4,3,4.5,NA,1.5,4,3,0.33,3,0.5,3,6.5,17,1,21,14,3,7,1,17,2.5,33,32,11,9,NA,2,3,1.5,1,NA,2.5,NA,NA,NA,NA,
                     NA,NA,NA,3,18,NA,2.5,NA,9,NA,8,15,12,2.5,20,2.5,17,10,20,6.5,6,1,10,2,0.83,6,0.33,8,1.16,
                     4,5,6,10,1.5,2,17,14,30,0.16,4,3,1,20,0.16,40,3,1,12,3.5,2.25,10,22,1,31,41,16,NA,35,
                     0.5,4,2.5,30,2,NA,4,2,NA,3,8,2,0.5,5,2.5,3,1.5,NA,0.33,4,NA,2,3,4,27,1.5,4,6,4,22,1.7,2,1.5,3.5,0.41,
                     7,6,1,0.08,1.5,7,0.41,4,2.5,2,2,12,7,0.66,NA,3,10,0.33,15,33,30,23,2,0.33,35,6,7,1,3,2,
                     1,3,10,NA,30,0.16,7,6,5,2,3,NA,NA,NA,4,2.5,4,NA,1.41,3,NA,NA,25,2,12,12,1.2,8,1.5,1
)

#creates demographic table using DT library

demo_table <- together %>% 
  select(`How many hours do you typically work per week in this job?`, tenure, 
         `What is the title of the job you were thinking about while responding to this survey?`) %>% 
  filter_all(any_vars(!is.na(.))) %>% #changed DT to filter out rows where all col values == NA
  datatable()

colnames(together)[39] <- "hours"     ## label too long

together$hours[together$hours > 90] <- NA

```

## Participants

`r num` individuals provided ratings across 36 candidate items. These participants were gathered via snowball sampling, with an initial population of undergraduate and graduate students, as well as professional acquaintances of faculty members. All surveys were administered via Qualtrics. Participant job title, hours worked per week, and organizational tenure were recorded. Mean hours worked per week was `r mean(together$hours, na.rm=TRUE)` (SD = `r sd(together$hours, na.rm=TRUE)`). Mean organizational tenure was `r mean(together$tenure, na.rm = TRUE)` years (SD = `r sd(together$tenure, na.rm = TRUE)`).

```{r hours, echo=FALSE, warning=FALSE, fig.cap="Distribution of mean hours worked per week",include=FALSE}

hours_hist <- ggplot(together) +
  geom_histogram(aes(x = hours)) +
  xlab("Hours worked per week") +
  ylab("Number of responses") +
  theme_apa() +
  ggtitle("How many hours do you typically work per week in this job?")

hours_hist
```

```{r tenure, echo=FALSE, warning=FALSE, fig.cap="Distribution of organizational tenure (years)", include=FALSE}
tenure_hist <- ggplot(together) +
  geom_histogram(aes(x = tenure)) + 
  xlab("Organizational tenure (years)") +
  ylab("Number of responses") +
  ggtitle("How long have you been with this organization?") +
  theme_apa()

tenure_hist
```

```{r job_table, fig.cap="ISCO professional categories of participants", include=FALSE}
job_table <- knitr::kable(job_groups, col.names = c("Professional category", "Count"))
job_table
```

Participants provided their job titles via an optional free text-entry box at the end of the survey. We classified job titles according to the International Standard Classification of Occupations (ISCO-8) via the *labourR* package [@R-labourR]. The ISCO hierarchically organizes jobs in increasing order of specificity. For example, the first level of the hierarchy distinguishes a professional from a clerical worker or a technician. On the second level, professionals are distinguished among each other by whether they are engineers, medical workers, lawyers, and so on. According to this classification, 120 of our participants were professionals, 51 were managers, 4 were clerical support workers, 3 were plant and machine operators, and 1 was a trade worker.

## Scale development "conditions"

In addition to an intentional bifactor structure, we wanted to also introduce procedural conditions regarding the effort to obtain final scale definitions. One team of scale reductionists therefore focused on corrected item-total correlations while the other based final scale definitions on CFA modification indices.

### Corrected item-total correlations

Using the *alpha* function from the *psych* package, we calculated corrected item-total correlations for all items. For each bifactor pair, we removed the item with the lowest corrected item-total correlation from the scale definition, leaving three items per dimension pair. We then re-ran our alpha analyses upon our 3-item definitions and repeated this process, leaving only two items per substantive-attitudinal pair which was our desired scale length (18 items).

### CFA Modification Indices

In our second approach, we followed two parallel stepwise item reduction processes centered around eliminating items in decreasing magnitude of confirmatory factor analysis (CFA) modification indices. Specifying 36-item substantive and attitudinal models independently, we requested modification indices from each, with the intent of retaining indicators whose fixed shared residual covariances were associated with high modification indices (indicating better model fit if the paths were freed). The item pair with the highest modification index was reviewed for association within the *other*, non-focal model. Here we prioritized item deletions such that an item was implicated for deletion if: 1) modification index was high (relative to others) and 2) error residual was within the same "cell". In cases where the highest modification index was between the only two remaining items in a substantive-attitudinal pair, these items were passed over for scrutiny in favor of the items with the next-highest index. This process was repeated until 18 items remained (i.e., 2 items for each of the 9 substantive-attitudinal pairs).

For example, the path with the highest modification index across both 36-item CFAs was between item 2 and item 4, which are both indicators of "Absorption" and "Cognition". One of these items was therefore a candidate for deletion, and semantic preference was given to item 4, "I find it difficult to mentally disconnect from work" over item 2. After item 2 was excluded from both scale definitions (substantive and attitudinal), the CFAs were re-run and modification indices re-checked for bi-factor structure optimizing modifications.

### Final scale definitions

Although we retained two different item reduction lenses for the purpose of SIOP presentation, we did also land upon a final scale definition. This final definition was a compromise between the CFA-derived and corrected item-total correlation-derived definitions. The final choice of item to delete or retain across the two different candidate models was based on author preference for wording/semantics as well as construct domain coverage (considering the possibility of construct deficiency). Item variance was also consulted as a practical consideration, with retention being more likely for the item exhibiting greater response variance.

```{r modindices, fig.cap="Sample modification index table"}

#figure out how to display this in the middle of the paper rather than a figure at the end of the paper  

mod <- data.frame(read.csv('att.csv', row.names = NULL)[1:7, 2:5])
mod2 <- mod[,-2]
mod2$Notes <- c("Candidate for deletion due to construct duplication", "", "Candidate for retention due to substantive construct association", "", "", "", "")

colnames(mod2) <- c('Element 1', 'Element 2', "Modification Index", "Notes") #Δχ2 isn't showing up properly in knit output. Fix.

mod <- apa_table(mod2, caption = "Attitudinal structure modification indices (36 item analysis)")
mod

#, align = c("m{2cm}","m{2cm}","m{2cm}","m{7cm}")
```

```{r CFAsub, echo=FALSE, warning=FALSE, fig.cap="Substantive factor structure CFA"}

## getting conditions into one large file below - 12/9/20

data$Cond1 <- rowSums(is.na(data[18:53]))
data$Cond2 <- rowSums(is.na(data[54:89]))
data$Cond3 <- rowSums(is.na(data[90:125]))
data$Cond4 <- rowSums(is.na(data[126:161]))

data$Condition[data$Cond1 < 36] <- 1
data$Condition[data$Cond2 < 36] <- 2
data$Condition[data$Cond3 < 36] <- 3
data$Condition[data$Cond4 < 36] <- 4

cond1 <- data[ which(data$Condition==1), ]
cond2 <- data[ which(data$Condition==2), ]
cond3 <- data[ which(data$Condition==3), ]
cond4 <- data[ which(data$Condition==4), ]

cond1.red <- cond1[,c(6, 18:53, 162:165, 171)]  ## using Cond1 ordering
cond2.red <- cond2[,c(6, 62:65, 70:73, 82:85, 58:61, 74:77, 86:89, 66:69, 78:81, 54:57, 162:165, 171)]
cond3.red <- cond3[,c(6, 94:97, 106:109, 118:121, 98:101, 110:113, 122:125, 102:105, 114:117, 90:93, 162:165, 171)]
cond4.red <- cond4[,c(6, 138:161, 130:137, 126:129, 162:165, 171)]        ## 171 versus 172 because testing script has extra "hours" variable

names(cond1.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond1.red))      ## Getting rid of condition markers so rbind will work
names(cond2.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond2.red))  
names(cond3.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond3.red))  
names(cond4.red) = gsub(pattern = "C*.* - ", replacement = "", x = names(cond4.red))  

together <- rbind(cond1.red, cond2.red, cond3.red, cond4.red)        ## we'll be using this object for analyses

num_valid <- nrow(together)

i <- c(1:37)                                          ## Changing item responses to numerics
together[ , i] <- apply(together[ , i], 2,            # Specify own function within apply
                        function(x) as.numeric(as.character(x)))


##########################################################
##########################################################
##########################################################
############# RECODES

together$`Most days, I feel happiest when the workday is soon to be complete.` <- 7 - together$`Most days, I feel happiest when the workday is soon to be complete.`
together$`This job drains my energy.` <- 7 - together$`This job drains my energy.`

## BEHAVIORAL (NONE):

## COGNITIVE: 

together$`Thinking about work saps my energy.` <- 7 - together$`Thinking about work saps my energy.`
together$`I often think about finding another job.` <- 7 - together$`I often think about finding another job.`


library(lavaan)
library(sem)
library(semPlot)
library(dplyr)
 

CFAdata<-together[,2:37]


CFAdata<-CFAdata%>%rename(
  Item_1=`Iâ€™m able to concentrate on my work without distractions.`,
  Item_2=`I have a hard time detaching mentally from my work.`,
  Item_3=`Time passes quickly while Iâ€™m working.`,
  Item_4=`I find it difficult to mentally disconnect from work.`,
  Item_5=`I enjoy thinking about work even when Iâ€™m not at work.`,
  Item_6=`Most days, I feel happiest when the workday is soon to be complete.`,
  Item_7=`I am happiest when I am immersed in a project.`,
  Item_8=`I love starting my workday.`,
  Item_9=`I devote more time than is expected of me.`,
  Item_10=`I have to be reminded to take breaks while Iâ€™m at work.`,
  Item_11=`I never miss a work deadline.`,
  Item_12=`I never allow distractions to interfere with my work.`,
  Item_13=`I devote my full attention to my work tasks throughout the day.`,
  Item_14=`Thinking about work saps my energy.`,
  Item_15=`I would rather direct my focus toward a work task than a personal task.`,
  Item_16=`Iâ€™m able to maintain good levels of energy throughout the workday.`,
  Item_17=`I enjoy spending time completing my job tasks.`,
  Item_18=`Most days I feel enthusiastic about starting my work day.`,
  Item_19=`I feel motivated to go beyond what is asked of me.`,
  Item_20=`This job drains my energy.`,
  Item_21=`When work is slow I find ways to be productive.`,
  Item_22=`I express enthusiasm for my job while at work.`,
  Item_23=`I try my best to perform well at work.`,
  Item_24=`If I notice my energy level is low, I take corrective steps to re-energize.`,
  Item_25=`I plan my future with this company.`,
  Item_26=`I believe this company cares about my career goals.`,
  Item_27=`I often think about finding another job.`,
  Item_28=`This organization challenges me to work at my full potential.`,
  Item_29=`I am proud to be a member of this organization.`,
  Item_30=`I feel supported by my supervisor when I fail at a task.`,
  Item_31=`I feel proud of my accomplishments within this organization.`,
  Item_32=`My job makes me feel like Iâ€™m part of something meaningful.`,
  Item_33=`I make valued contributions to the organization.`,
  Item_34=`I embrace challenging situations at work.`,
  Item_35=`I speak positively about this organization to others.`,
  Item_36=`This organization provides the resources necessary for me to successfully perform my job.`
)




```

```{r CFAcasey, echo=FALSE, warning=FALSE}

modified21 <-'
Absorption = ~Item_1 + Item_3  + Item_5  + Item_8  + Item_9 + Item_10
Vigor      = ~Item_13 + Item_16 + Item_17 + Item_18 + Item_22 + Item_23
Dedication = ~ Item_25 + Item_26 + Item_31 + Item_32 + Item_33 + Item_35
Cognitive  = ~Item_1  + Item_3  + Item_13 + Item_16 + Item_25 + Item_26
Affective  = ~Item_5 +  Item_8  + Item_17 + Item_18 + Item_31 + Item_32
Behavioral = ~Item_9 + Item_10 + Item_22 + Item_23 + Item_33 + Item_35
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor      ~~ 0*Affective
Vigor      ~~ 0*Behavioral
Vigor      ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'

Fit.mod21 <- lavaan::cfa(modified21, data = CFAdata, missing = "ML", estimator = 'MLR')
fit.mod21 <- as.data.frame(fitMeasures(Fit.mod21))
fig.mod21 <- round(fit.mod21[1],2)

```

```{r CFAmodindices, echo=FALSE, warning=FALSE}

modified22 <-'
Absorption = ~Item_2 + Item_3  + Item_7  + Item_8  + Item_10 + Item_11
Vigor      = ~Item_14 + Item_16 + Item_17 + Item_19 + Item_21 + Item_22
Dedication = ~ Item_26 + Item_28 + Item_31 + Item_32 + Item_34 + Item_35
Cognitive  = ~Item_2  + Item_3  + Item_14 + Item_16 + Item_26 + Item_28
Affective  = ~Item_7 +  Item_8  + Item_17 + Item_19 + Item_31 + Item_32
Behavioral = ~Item_10 + Item_11 + Item_21 + Item_22 + Item_34 + Item_35
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor      ~~ 0*Affective
Vigor      ~~ 0*Behavioral
Vigor      ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'

Fit.mod22 <- lavaan::cfa(modified22, data = CFAdata, missing = "ML", estimator = 'MLR')
fit.mod22 <- as.data.frame(fitMeasures(Fit.mod22))
fig.mod22 <- round(fit.mod22[1],2)

```

```{r CFAatt1, echo=FALSE, warning=FALSE, fig.cap="Substantive factor measurement model"}
Sub_Model<-'
Absorption = ~Item_1 + Item_3  + Item_5  + Item_8  + Item_10 + Item_11
Vigor      = ~Item_14 + Item_16 + Item_17 + Item_19 + Item_21 + Item_22
Dedication = ~ Item_26 + Item_28 + Item_31 + Item_32 + Item_34 + Item_35
'

Fit1.1<-lavaan::cfa(Sub_Model, data = CFAdata)
# semPlot::semPaths(Fit1.1, "std")

semPlot::semPaths(Fit1.1, what="std", sizeLat=10, style="lisrel",
              sizeMan=4.5,edge.label.cex=0.75, edge.color="black", asize=2, rotation=4)


# summary(Fit1.1, fit.measure=TRUE)

# write.csv(modindices(Fit1.1, sort=TRUE), "fit_substantive.csv")
```

```{r CFAatt2, echo=FALSE, warning=FALSE, fig.cap="Attitudinal factor measurement model"}
Att_Model<-'
Cognitive  = ~Item_1  + Item_3  + Item_14 + Item_16 + Item_26 + Item_28
Affective  = ~Item_5 +  Item_8  + Item_17 + Item_19 + Item_31 + Item_32
Behavioral = ~Item_10 + Item_11 + Item_21 + Item_22 + Item_34 + Item_35
'
Fit1.2<-lavaan::cfa(Att_Model, data = CFAdata)
semPlot::semPaths(Fit1.2,what="std", sizeLat=10, style="lisrel",
              sizeMan=4.5,edge.label.cex=0.75, edge.color="black", asize=2, rotation=2)
# lavaan::fitMeasures(Fit1.2)
# summary(Fit1.2, fit.measure=TRUE)

```

```{r CFAatt3, echo=FALSE, warning=FALSE, fig.cap="Bifactor measurement model"}

modified2 <-'
Absorption = ~Item_1 + Item_3  + Item_5  + Item_8  + Item_10 + Item_11
Vigor      = ~Item_14 + Item_16 + Item_17 + Item_19 + Item_21 + Item_22
Dedication = ~ Item_26 + Item_28 + Item_31 + Item_32 + Item_34 + Item_35
Cognitive  = ~Item_1  + Item_3  + Item_14 + Item_16 + Item_26 + Item_28
Affective  = ~Item_5 +  Item_8  + Item_17 + Item_19 + Item_31 + Item_32
Behavioral = ~Item_10 + Item_11 + Item_21 + Item_22 + Item_34 + Item_35
Absorption ~~ 0*Affective
Absorption ~~ 0*Behavioral
Absorption ~~ 0*Cognitive
Vigor      ~~ 0*Affective
Vigor      ~~ 0*Behavioral
Vigor      ~~ 0*Cognitive
Dedication ~~ 0*Affective
Dedication ~~ 0*Behavioral
Dedication ~~ 0*Cognitive
'

Fit.mod2 <- lavaan::cfa(modified2, data = CFAdata, missing = "ML", estimator = 'MLR')

# semPlot::semPaths(Fit.mod2, bifactor = c("Cognitive", "Affective", "Behavioral"), "std", layout = "tree3",
#                  rotation = 2, curvePivot=TRUE, style="lisrel", nCharNodes = 0, pastel=FALSE)

semPlot::semPaths(Fit.mod2, bifactor = c("Cognitive", "Affective", "Behavioral"), style="lisrel", "std", layout = "tree3", sizeLat=10, rotation = 2, sizeMan=4.5,edge.label.cex=0.75, edge.color="black", asize=2)


# modindices(Fit.mod2, sort = TRUE, maximum.number = 25)

# summary(Fit.mod2, standardized=TRUE)

```

```{r fitmeasures}

# into data frames
fit1.1 <- as.data.frame(fitMeasures(Fit1.1))
fit1.1$`fitMeasures(Fit1.1)` <- round(fit1.1$`fitMeasures(Fit1.1)`, 2)

fit1.2 <- as.data.frame(fitMeasures(Fit1.2))
fit1.2$`fitMeasures(Fit1.2)` <- round(fit1.2$`fitMeasures(Fit1.2)`, 2)

fit.mod2 <- as.data.frame(fitMeasures(Fit.mod2))
fit.mod2$`fitMeasures(Fit.mod2)` <- round(fit.mod2$`fitMeasures(Fit.mod2)`, 2)

indices_att <- as.data.frame(t(fit1.1[c(3,4,23,29,9,10,19),]))        ## Chi-sq, df, RMSEA, SRMR, CFI, TLI, AIC
indices_sub <- as.data.frame(t(fit1.2[c(3,4,23,29,9,10,19),]))
indices_bi <- as.data.frame(t(fit.mod2[c(3,4,44,58,17,18,38),]))

fits <- rbind(indices_att, indices_sub, indices_bi)
names(fits) <- c("Chi Square", "df", "RMSEA", "SRMR", "CFI", "TLI", "AIC")
model <- c("Attitudinal", "Substantive", "bifactor")
fits2 <- cbind(model, fits)

apa_table(fits2, caption = "Summary fit statistics (18 item final proposed scale definitions)")

```

# Results

We used `r cite_r("r-references.bib")` for all analyses.

The eventual 18-item scale definitions identified via the two item reduction procedures are presented in Table XX. Subjecting these two structures to bifactor constraints was accomplished via full information maximum likelihood estimation, with the corrected item-total definition, somewhat surprisingly, resulting in a better fit ($\chi^2$ = `r fig.mod21[3,1]`, RMSEA = `r fig.mod21[45,1]`, AIC = `r fig.mod21[39,1]`) than the CFA modification-index derived bifactor solution ($\chi^2$ = `r fig.mod22[3,1]`, RMSEA = `r fig.mod22[45,1]`, AIC = `r fig.mod22[39,1]`).

```{r scales}

papaja::apa_table(read.csv("items.csv"), caption = "Final proposed scale definitions (derived via attendance to corrected item-total correlations or CFA modification indices)")

```

```{r alphas}

abs <- psych::alpha(CFAdata[c(1,3,5,8,10,11)])
vig <- psych::alpha(CFAdata[c(14,16,17,19,21,22)])
ded <- psych::alpha(CFAdata[c(26,28,31,32,34,35)])
aff <- psych::alpha(CFAdata[c(1,3,14,16,26,28)])
cog <- psych::alpha(CFAdata[c(5,8,17,19,31,32)])
beh <- psych::alpha(CFAdata[c(10,11,21,22,34,35)])

```

## Final scale definitions


As alluded to above, rather than relying exclusively on empirical superiority, final scale definitions were also informed by considerations of content domain coverage, which slightly favored the CFA modification index-informed definition. Final scale $\alpha$'s were `r round(abs$total$raw_alpha,2)` (Absorption), `r round(ded$total$raw_alpha,2)` (Dedication), `r round(vig$total$raw_alpha,2)` (Vigor), `r round(aff$total$raw_alpha,2)` (Affect), `r round(cog$total$raw_alpha,2)` (Cognition), and `r round(beh$total$raw_alpha,2)` (Behavior). Correlations among unit-weighted scale aggregates are presented in Table XX.

```{r unitweight}

Absorption <- rowMeans(CFAdata[c(1,3,5,8,10,11)], na.rm=TRUE)
Vigor <- rowMeans(CFAdata[c(14,16,17,19,21,22)], na.rm=TRUE)
Dedication <- rowMeans(CFAdata[c(26,28,31,32,34,35)], na.rm=TRUE)
Affect <- rowMeans(CFAdata[c(1,3,14,16,26,28)], na.rm=TRUE)
Cognition <- rowMeans(CFAdata[c(5,8,17,19,31,32)], na.rm=TRUE)
Behavior <- rowMeans(CFAdata[c(10,11,21,22,34,35)], na.rm=TRUE)

new <- as.data.frame(cbind(Absorption, Vigor,Dedication,Affect,Cognition,Behavior))

r <- corx::corx(new,                     ## can extend if needed
                triangle = "lower",
                stars = c(0.05, 0.01, 0.001),
                describe = c(`$M$` = mean, `$SD$` = sd))

papaja::apa_table(r$apa, # apa contains the data.frame needed for apa_table
                  caption = "Unit-weighted scale intercorrelations (all conditions).",
                  note = "* p < 0.05; ** p < 0.01; *** p < 0.001",
                  landscape = TRUE,
                  escape = F)
```

> For KULAS to do: two sections 1) 6x6 correlation matrix between scale scores 2) corrected item-total correlations

```{r final, fig.cap="Final scale definition"}
item_number <- seq(1:36)

text <- c("I am able to concentrate on my work without distractions.",
"I have a hard time detaching mentally from my work.",
"Time passes quickly while I'm working.",
"I find it difficult to mentally disconnect from work.",
"I enjoy thinking about work even when I'm not at work.",
"Most days, I feel happiest when the workday is soon to be complete.",
"I am happiest when I am immersed in a project.",
"I love starting my workday.",
"I devote more time than is expected of me.",
"I have to be reminded to take breaks while I'm at work.",
"I never miss a work deadline.",
"I never allow distractions to interfere with my work.",
"I devote my full attention to my work tasks throughout the day.",
"Thinking about work saps my energy.",
"I would rather direct my focus toward a work task than a personal task.",
"I'm able to maintain good levels of energy throughout the workday.",
"I enjoy spending time completing my job tasks.",
"Most days I feel enthusiastic about starting my work day.",
"I feel motivated to go beyond what is asked of me.",
"This job drains my energy.",
"When work is slow I find ways to be productive.",
"I express enthusiasm for my job while at work.",
"I try my best to perform well at work.",
"If I notice my energy level is low, I take corrective steps to re-energize.",
"I plan my future with this company.",
"I believe this company cares about my career goals.",
"I often think about finding another job.",
"This organization challenges me to work at my full potential.",
"I am proud to be a member of this organization.",
"I feel supported by my supervisor when I fail at a task.",
"I feel proud of my accomplishments within this organization.",
"My job makes me feel like I'm part of something meaningful.",
"I make valued contributions to the organization.",
"I embrace challenging situations at work.",
"I speak positively about this organization to others.",
"This organization provides the resources necessary for me to successfully perform my job."
)

Dimension1 <- c(rep("Absorption", 12), rep("Vigor", 12), rep("Dedication", 12))
Dimension2 <- rep(c(rep("Cognitive", 4), rep("Affective", 4), rep("Behavioral", 4)),3)
Final <- c("Included",
"",
"Included",
"",
"Included",
"",
"",
"Included",
"Included",
"Included",
"",
"",
"Included",
"",
"",
"Included",
"Included",
"Included",
"",
"",
"",
"Included",
"Included",
"",
"Included",
"Included",
"",
"",
"",
"",
"Included",
"Included",
"Included",
"",
"Included",
"")

item_table <- data.frame("Number" = item_number, "Item text" = text, "Dimension 1" = Dimension1, "Dimension 2" = Dimension2, Final)
item_table <- papaja::apa_table(item_table)
item_table
```

# Discussion

The purpose of this study was to document the development of an intentionally complex, bifactor measure of employee engagement. To add an additional element of insterest regarding the SIOP audience, we furthermore followed two divergent approaches that resulted in slightly different scale definitions. Surprisingly, the approach focusing on facet-level internal consistency maximization resulted in a better fitting CFA than did the approach focusing on CFA fit! Ultimately, differences were reconciled via qualitative consideration of content domain coverage, and the proposed 18-item final solution is a compromise between the two "experimental" models.

The unit-weighted inter-scale correlations exhibit only moderately high association (in the .6-ish range), which is promising and perhaps provides some support for retention of the 3-facet substantive model, which has been criticized for high observed inter-scale associations [e.g., see @kulikowski2017we].

Our research contributes to theory in two key ways. Firstly, it introduces a novel measure of engagement, developed in English, that will allow future researchers to further probe the tripartite attitudinal structure of the construct. To our knowledge, ours is the only engagement scale that probes the specific attitudinal dimensions of engagement.

Secondly, we more generally advance the use of bifactor analysis as an alternative approach to testing and comparing structural models of constructs that extends beyond investigations of common method variance. In the context of attitudinal constructs, it may be appropriate to examine the possibility of bifactor solutions that conform to attitudinal structure. We hope that this endeavor encourages other researchers to also extend the bifactor procedure to novel measurement pursuits.

In addition to the information provided in this presentation, we have also documented evidence of convergent and discriminant validity of these scales, although the scope of that extends beyond a single SIOP presentation. We do have a much larger technical report that documents the information in this paper as well as broader explorations of instrument criterion- and construct-validation and that technical report is currently published as an open-access document - our items are also intentionally carry no copyright and are freely available to any researcher or practitioner interested in the topic of employee engagment.

Bifactor analysis may be a valuable method of reconciling previously at-odds approaches to describing the same construct.

We show that a scale can exhibit high internal consistency while simultaneously measuring two different structural models. It is our hope that the success of this approach might evangelize bifactor analysis and the more general approach of consolidating and integrating theories rather than parsing them.

\newpage

# References

```{=tex}
\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}
```
::: {#refs custom-style="Bibliography"}
:::

\endgroup
